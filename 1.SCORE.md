# スコア計算ロジック
- [スコアリングアルゴリズムの実装](https://github.com/yanokkpj/bigfive-web-clone/blob/main/packages/score/src/index.ts)


## １．計算プロセス
1. **データ収集**: 各質問への回答をドメイン（主要特性）とファセット（副特性）ごとに分類
2. **ドメイン集計**:
   - 同一ドメインのスコアを合算
   - 最終的に回答数で除算し平均値を算出
   - 式: `ドメインスコア = Σ(回答値) / 回答数`

3. **ファセット集計**:
   - ドメイン内の各ファセットごとにスコアを合算
   - 最終的に当該ファセットの回答数で除算
   - 式: `ファセットスコア = Σ(ファセット回答値) / ファセット回答数`

4. **結果判定**:
   - 平均スコアに基づいて "high", "neutral", "low" に分類
   - 判定基準: 
     * 平均スコア > 3.5: "high"
     * 平均スコア < 2.5: "low"
     * それ以外: "neutral"

## ２．閾値決定根拠
- **3.5閾値**: 5段階評価の62.5%地点（(3.5-1)/4=62.5%）
- **2.5閾値**: 5段階評価の37.5%地点（(2.5-1)/4=37.5%）
- 分類境界を明確化するため、中央値3を跨ぐ範囲をneutralと定義

## ３．分類基準

### スコア範囲と解釈
| 平均スコア | パーセンタイル | 分類    | 解釈                          |
|------------|---------------|---------|-------------------------------|
| 3.5+       | 62.5%+        | high    | 上位20%に相当する特性強度     |
| 2.5-3.5    | 37.5%-62.5%   | neutral | 平均範囲（中央60%）          |
| ～2.5      | ～37.5%       | low     | 下位20%に相当する特性強度     |

## ４．判定特性
1. **二重階層構造**: ドメインとファセットで独立した判定
2. **スケール不変性**: 異なる質問数でも平均値で比較可能
3. **非線形分類**: 中央値周辺を広くneutral判定
4. **解釈安定化**: 極端な値のみをhigh/lowと判定

## ５．インターフェース定義

### 入力データ (Answer)
```typescript
interface Answer {
  domain: string      // ドメイン（主要特性）の識別子
  facet?: number      // ファセット（副特性）の識別子（オプショナル）
  score: number       // 回答スコア（通常1-5の値）
}
```

### 出力データ (Result)
```typescript
interface Result {
  score: number       // ドメインの合計スコア
  count: number       // ドメインの回答数
  result: string      // ドメインの判定結果（'high', 'neutral', 'low'）
  facet: Record<string, {  // ファセット別結果
    score: number,    // ファセットの合計スコア
    count: number,    // ファセットの回答数
    result: string    // ファセットの判定結果（'high', 'neutral', 'low'）
  }>
}
```